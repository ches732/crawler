<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Why Checked Exceptions Failed</title>
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="https://borretti.me/assets/card/why-checked-exceptions-failed.jpg">
    <meta property="og:image" content="https://borretti.me/assets/card/why-checked-exceptions-failed.jpg" />
    
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://borretti.me/article/why-checked-exceptions-failed" />
    <meta property="og:title" content="Why Checked Exceptions Failed" />
    <meta property="og:description" content="Programming language features are never orthogonal." />
    <meta property="og:site_name" content="Fernando Borretti" />
    <meta name="author" content="Fernando Borretti" />
    <meta name="description" content="Programming language features are never orthogonal." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="/assets/main.css" />
    
    <meta property="article:published_time" content="2023-07-15T00:00:00+00:00" />
    
    
    <link rel="canonical" href="https://borretti.me/article/why-checked-exceptions-failed" />
    
  </head>
  <body>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6MB79EDK0Q"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6MB79EDK0Q');
    </script>
    

<div class="layout-common">
  <nav class="top-nav" role="navigation">
    <ul>
      <li>
        <a href="/">Home</a>
      </li>
      
      <li>
        <span class="sep">❖</span>
      </li>
      <li>
        <a href="/article/">Articles</a>
      </li>
      
    </ul>
  </nav>
  <main>
    <div class="layout-article">
  <header>
    <h1>Why Checked Exceptions Failed</h1>
  </header>
  <article>
    <p>Java has this feature called checked exceptions, which lets you <a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-8.html#jls-8.4.6">annotate</a>
a method with the set of exceptions it may throw, like so:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kt">void</span> <span class="nf">foo</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">FooException</span><span class="o">,</span> <span class="nc">BarException</span> <span class="o">{</span>
  <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Methods that call <code class="language-plaintext highlighter-rouge">foo()</code> must either explicitly catch <code class="language-plaintext highlighter-rouge">FooException</code> and
<code class="language-plaintext highlighter-rouge">BarException</code>, or otherwise annotate themselves with the set of exceptions they
don’t handle and which propagate up from them.</p>

<p>Nobody uses this. Why? Because the rest of the language is missing.</p>

<p>The central concepts of most programming languages are values and types. All of
the machinery of the language is, in one way or another, about transforming
values into other values, or transforming types into other types. We can do a
lot of things with values and types.</p>

<p>Functions and methods have a <em>signature</em>: the types of the parameters, and the
return type. Java added extra information to method signatures, orthogonal to
the types: the set of exceptions the method can throw. But the rest of the
machinery is missing.</p>

<p>Say I have an interface with a method <code class="language-plaintext highlighter-rouge">foo</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ExampleInterface</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">foo</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>How does this interact with checked exceptions? Can I write this?</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExampleClass</span> <span class="kd">implements</span> <span class="nc">ExampleInterface</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">foo</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IOException</span><span class="o">(</span><span class="s">"Oh no!"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Obviously not:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>error: foo() in ExampleClass cannot implement foo() in ExampleInterface
    public void foo() throws IOException {
                ^
overridden method does not throw IOException
</code></pre></div></div>

<p>Because the code that uses the interface, rather than the class, has no way of
seeing this.</p>

<p>Can I specify that implementations of <code class="language-plaintext highlighter-rouge">foo</code> can throw no, some, or all
exceptions? What would it even mean to write something like <code class="language-plaintext highlighter-rouge">throws *</code>?
Analogously, if I have a function that takes a method as an argument, like a
callback, how do I specify what set of exceptions in can throw? Can I have
generic “exception set parameters”?</p>

<p>It starts with a very simple and laudable goal: let’s add extra information to
the type signature, orthogonal to the types, so we can track exceptions,
computational effects, maybe even things like stack usage or whether the
function is recursive. And before long you’re overwhelmed with subtyping
relationships between effects, lattice theory, covariance and contravariance of
effects.</p>

<p>Concretely, checked exceptions in Java failed because Java lacks “throwingness
polymorphism”, if you will.</p>

<p>Functional error handling, using <code class="language-plaintext highlighter-rouge">Option</code> and <code class="language-plaintext highlighter-rouge">Result</code> types, is rapidly
becoming the standard operating procedure in essentially every language, because
it relies on nothing but <em>values</em> and <em>types</em>. They are more of the same, and so
they fit right into the existing language machinery.</p>

<p>More broadly: in programming languages, <em>everything impinges on everything
else</em>. Which is why you can’t bolt a type system or an ownership system on a
language after the fact. At least, not without massive holes you will cope about
and deny exist.</p>

<p>Was Java wrong to add checked exceptions? No. They took a risk and it didn’t pay
off. The design flaws in programming languages are not necessarily evident until
you write tens of thousands, or hundreds of thousands, or millions of lines of
code. They can only be evaluated in the large.</p>

  </article>
</div>

  </main>
  <nav class="bottom-nav">
    <ul>
      <li>
        <a href="/">Home</a>
      </li>
      <li>
        <span class="sep">—</span>
      </li>
      <li>
        <a href="/about">About</a>
      </li>
      <li>
        <span class="sep">—</span>
      </li>
      <li>
        <a href="/portfolio">Portfolio</a>
      </li>
      <li>
        <span class="sep">—</span>
      </li>
      <li>
        <a href="/article">Articles</a>
      </li>
      <li>
        <span class="sep">—</span>
      </li>
      <li>
        <a href="/fiction">Fiction</a>
      </li>
      <li>
        <span class="sep">—</span>
      </li>
      <li>
        <a href="/feed.xml">RSS</a>
      </li>
    </ul>
  </nav>
  <footer>
    <div class="copy">
      &copy; 2014 – 2023 Fernando Borretti.
    </div>
  </footer>
</div>

    <script defer data-domain="borretti.me" src="https://plausible.io/js/plausible.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inconsolata&display=swap" rel="stylesheet" />
    
  </body>
</html>
